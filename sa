SELECT crm.code,crm.[NAME],sod.SINGLE_MAX_WITH_INF,sod.TWIN_MAX_WITH_INF,sod.DOUBLE_MAX_WITH_INF,TRIPLE_MAX_WITH_INF,sod.QUAD_MAX_WITH_INF,sod.OTHER_MAX_WITH_INF FROM [AS-DTGTHA].dbo.CRM 
LEFT JOIN [AS-DTGTHA].dbo.SOD on crm.SOD_ID = sod.SOD_ID
where sod.SINGLE_MAX_WITH_INF > 900 
or sod.TWIN_MAX_WITH_INF > 900
or sod.TRIPLE_MAX_WITH_INF > 900
or sod.DOUBLE_MAX_WITH_INF > 900
or sod.QUAD_MAX_WITH_INF > 900
or sod.OTHER_MAX_WITH_INF > 900;


SELECT [LOCATION],SERVICE,SUPPLIER,CODE as [CODE], [LOCATION]+SERVICE+SUPPLIER+CODE as PRODUCTCODE,sod.SINGLE_MAX_WITH_INF,sod.TWIN_MAX_WITH_INF,sod.DOUBLE_MAX_WITH_INF,TRIPLE_MAX_WITH_INF,sod.QUAD_MAX_WITH_INF,sod.OTHER_MAX_WITH_INF  FROM [AS-DTGTHA].dbo.OPT
LEFT JOIN [AS-DTGTHA].dbo.SOD on opt.SOD_ID = sod.SOD_ID
where (sod.SINGLE_MAX_WITH_INF > 900 
or sod.TWIN_MAX_WITH_INF > 900
or sod.TRIPLE_MAX_WITH_INF > 900
or sod.DOUBLE_MAX_WITH_INF > 900
or sod.QUAD_MAX_WITH_INF > 900
or sod.OTHER_MAX_WITH_INF > 900) 
and opt.AC = 'Y'
and opt.SERVICE = 'AC'
and sod.POLICY_TYPE = 'O'
and opt.DELETED = 0
;


SELECT crm.code,crm.[NAME],sod.SINGLE_AVAIL,sod.SINGLE_MAX,sod.SINGLE_AD_MAX,sod.SINGLE_MAX_WITH_INF
,sod.TWIN_AVAIL,sod.TWIN_MAX,sod.TRIPLE_AD_MAX,sod.TWIN_MAX_WITH_INF
,sod.DOUBLE_AVAIL,sod.DOUBLE_MAX,sod.DOUBLE_AD_MAX,sod.DOUBLE_MAX_WITH_INF
,sod.TRIPLE_AVAIL,sod.TRIPLE_MAX,sod.TRIPLE_AD_MAX,sod.TRIPLE_MAX_WITH_INF
,sod.QUAD_AVAIL,sod.QUAD_MAX,sod.QUAD_AD_MAX,sod.QUAD_MAX_WITH_INF
,sod.OTHER_AVAIL,sod.OTHER_MAX,sod.OTHER_AD_MAX,sod.OTHER_MAX_WITH_INF 
FROM [AS-DTGTHA].dbo.CRM 
LEFT JOIN [AS-DTGTHA].dbo.SOD on crm.SOD_ID = sod.SOD_ID
where 
(sod.SINGLE_AVAIL = 1 and (sod.SINGLE_MAX = 0 or sod.SINGLE_AD_MAX = 0 or sod.SINGLE_MAX_WITH_INF = 0))
or (sod.TWIN_AVAIL = 1 and (sod.TWIN_MAX = 0 or sod.TWIN_AD_MAX = 0 or sod.TWIN_MAX_WITH_INF = 0))
or (sod.DOUBLE_AVAIL = 1 and (sod.DOUBLE_MAX = 0 or sod.DOUBLE_AD_MAX = 0 or sod.DOUBLE_MAX_WITH_INF = 0))
or (sod.TRIPLE_AVAIL = 1 and (sod.TRIPLE_MAX = 0 or sod.TRIPLE_AD_MAX = 0 or sod.TRIPLE_MAX_WITH_INF = 0))
or (sod.QUAD_AVAIL = 1 and (sod.QUAD_MAX = 0 or sod.QUAD_AD_MAX = 0 or sod.QUAD_MAX_WITH_INF = 0))
or (sod.OTHER_AVAIL = 1 and (sod.OTHER_MAX = 0 or sod.OTHER_AD_MAX = 0 or sod.OTHER_MAX_WITH_INF = 0));

SELECT sod.SOD_ID,[LOCATION],SERVICE,SUPPLIER,CODE as [CODE], [LOCATION]+SERVICE+SUPPLIER+CODE as PRODUCTCODE,sod.SINGLE_AVAIL,sod.SINGLE_MAX,sod.SINGLE_AD_MAX,sod.SINGLE_MAX_WITH_INF
,sod.TWIN_AVAIL,sod.TWIN_MAX,sod.TRIPLE_AD_MAX,sod.TWIN_MAX_WITH_INF
,sod.DOUBLE_AVAIL,sod.DOUBLE_MAX,sod.DOUBLE_AD_MAX,sod.DOUBLE_MAX_WITH_INF
,sod.TRIPLE_AVAIL,sod.TRIPLE_MAX,sod.TRIPLE_AD_MAX,sod.TRIPLE_MAX_WITH_INF
,sod.QUAD_AVAIL,sod.QUAD_MAX,sod.QUAD_AD_MAX,sod.QUAD_MAX_WITH_INF
,sod.OTHER_AVAIL,sod.OTHER_MAX,sod.OTHER_AD_MAX,sod.OTHER_MAX_WITH_INF 
FROM [AS-DTGTHA].dbo.OPT
LEFT JOIN [AS-DTGTHA].dbo.SOD on opt.SOD_ID = sod.SOD_ID
where 
1=1
and ((sod.SINGLE_AVAIL = 1 and (sod.SINGLE_MAX = 0 or sod.SINGLE_AD_MAX = 0 or sod.SINGLE_MAX_WITH_INF = 0))
or (sod.TWIN_AVAIL = 1 and (sod.TWIN_MAX = 0 or sod.TWIN_AD_MAX = 0 or sod.TWIN_MAX_WITH_INF = 0))
or (sod.DOUBLE_AVAIL = 1 and (sod.DOUBLE_MAX = 0 or sod.DOUBLE_AD_MAX = 0 or sod.DOUBLE_MAX_WITH_INF = 0))
or (sod.TRIPLE_AVAIL = 1 and (sod.TRIPLE_MAX = 0 or sod.TRIPLE_AD_MAX = 0 or sod.TRIPLE_MAX_WITH_INF = 0))
or (sod.QUAD_AVAIL = 1 and (sod.QUAD_MAX = 0 or sod.QUAD_AD_MAX = 0 or sod.QUAD_MAX_WITH_INF = 0))
or (sod.OTHER_AVAIL = 1 and (sod.OTHER_MAX = 0 or sod.OTHER_AD_MAX = 0 or sod.OTHER_MAX_WITH_INF = 0)))
and opt.AC = 'Y'
and opt.SERVICE = 'AC'
and sod.POLICY_TYPE = 'O'
and opt.DELETED = 0;
